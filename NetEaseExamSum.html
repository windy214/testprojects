<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<table class="report">
			<tbody>
				<tr> <th>发布时间</th> <th>计分类型</th> <th>名称</th> <th>得分</th> </tr>  
				<tr> <td>2016年07月13日</td> <td>测验</td> <td>基础篇的单元测验</td> <td>32分/32分</td> </tr>  
				<tr> <td>2016年07月19日</td> <td>测验</td> <td>进阶篇的单元测验</td> <td>30分/30分</td> </tr>  
			</tbody>
		</table>
		<script type="text/javascript">
			var table = document.getElementsByClassName("report")[0];
			var rows = table.getElementsByTagName('tr');
			var testNum = 0,assignNum=0,examNum=0;
			var testPercent = 0,assignPercent=0,examPercent=0;
			for(var i=0,n=rows.length;i<n;i++){
				var cells = rows[i].getElementsByTagName('td');
				if(cells.length == 0) continue;
				switch (cells[1].innerHTML){
					case "测验":
					testPercent += calculate(cells[3].innerHTML);
					testNum++;
					break;
					case "作业":
					assignPercent += calculate(cells[3].innerHTML);
					assignNum++;
					break;
					case "考试":
					examPercent += calculate(cells[3].innerHTML);
					examNum++;
					break;
					
				}
			}
			(function (){//计算总分
				debugger
				var testScore = testPercent/testNum * 20 || 0;
				var assignScore = assignPercent/assignNum * 15 || 0;
				var examScore = examPercent/examNum * 50 || 0;
				console.log(testScore + assignScore + examScore +15);
			})();
			function calculate(text){
				debugger
				var _val = text.split('/');
				_val[0] = _val[0].match(/\d+(\.\d+)*/)[0];
				_val[1] = _val[1].match(/\d+(\.\d+)*/)[0];
				return _val[0]/_val[1];
			}
		</script>
	</body>
</html>
